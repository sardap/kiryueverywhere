(function(e){function t(t){for(var c,o,a=t[0],r=t[1],l=t[2],h=0,d=[];h<a.length;h++)o=a[h],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(c in r)Object.prototype.hasOwnProperty.call(r,c)&&(e[c]=r[c]);u&&u(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],c=!0,a=1;a<n.length;a++){var r=n[a];0!==s[r]&&(c=!1)}c&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var c={},s={app:0},i=[];function o(t){if(c[t])return c[t].exports;var n=c[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=c,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)o.d(n,c,function(t){return e[t]}.bind(null,c));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/kiryueverywhere/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],r=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=r;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"81cf":function(e,t,n){"use strict";n("cc99")},9244:function(e,t,n){"use strict";n("c9c8")},c9c8:function(e,t,n){},cc99:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);var c=n("7a23");const s=Object(c["d"])("h2",null,"🗺️ KIRYU EVERYWHERE! 🗺️",-1),i={key:0},o=Object(c["d"])("h3",null,"THIS HAS NOTHING TO DO WITH SEGA",-1),a=Object(c["d"])("h3",null,[Object(c["e"])("MADE BY "),Object(c["d"])("a",{href:"paul@sarda.dev"},"paul@sarda.dev")],-1),r={key:1},l=Object(c["d"])("h2",{class:"emergency_font"},[Object(c["e"])(" This is bad please email "),Object(c["d"])("a",{href:"paul@sarda.dev"},"paul@sarda.dev"),Object(c["e"])(" and tell him he forgot to update the site. ")],-1),u=[l],h={for:"debug_checkbox"},d={key:2},b=Object(c["d"])("p",null,"Select location",-1),g=Object(c["d"])("br",null,null,-1),m=Object(c["d"])("br",null,null,-1);function _(e,t,n,l,_,p){const O=Object(c["m"])("Game");return Object(c["h"])(),Object(c["c"])("div",null,[s,this.game_found?(Object(c["h"])(),Object(c["c"])("div",i,[Object(c["d"])("h3",null,"LOCATION #"+Object(c["n"])(this.location_number),1),Object(c["d"])("p",null,Object(c["n"])(e.getGameName().toUpperCase()),1),Object(c["f"])(O,{map:e.getMap(),number:this.location_number,threshold:e.getThreshold(),target:e.getTarget(),debug_mode:this.debug_mode,on_complete:e.onComplete()},null,8,["map","number","threshold","target","debug_mode","on_complete"]),o,a])):(Object(c["h"])(),Object(c["c"])("div",r,u)),Object(c["d"])("div",null,[Object(c["q"])(Object(c["d"])("input",{type:"checkbox",id:"debug_checkbox","onUpdate:modelValue":t[0]||(t[0]=t=>e.debug_mode=t)},null,512),[[c["o"],e.debug_mode]]),Object(c["d"])("label",h,"Debug Mode: "+Object(c["n"])(e.debug_mode),1)]),e.debug_mode?(Object(c["h"])(),Object(c["c"])("div",d,[b,Object(c["q"])(Object(c["d"])("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.location_number=t)},null,512),[[c["p"],e.location_number]]),g,m,Object(c["d"])("button",{onClick:t[2]||(t[2]=t=>e.resetCookie())},"Reset Cookie"),Object(c["d"])("p",null,"Cookie: "+Object(c["n"])(this.current_cookie),1),Object(c["d"])("button",{onClick:t[3]||(t[3]=t=>e.getCookie())},"Update Gotten Cookie")])):Object(c["b"])("",!0)])}var p=n("9ab4"),O=n("ce1f");const y=e=>(Object(c["k"])("data-v-31c4f660"),e=e(),Object(c["i"])(),e),j={class:"game"},f=["src"],k=y(()=>Object(c["d"])("br",null,null,-1)),v={class:"buttons"},x={key:0},w={key:1},C={key:0},I=y(()=>Object(c["d"])("h2",null,"YOU WON",-1)),S={key:1},T=y(()=>Object(c["d"])("h2",null,"YOU LOST",-1)),$=y(()=>Object(c["d"])("h3",null,"TRY AGAIN TOMORROW!",-1)),E=[T,$],L=y(()=>Object(c["d"])("br",null,null,-1)),M=y(()=>Object(c["d"])("br",null,null,-1)),N={key:2},U={key:3},P=["src"],A=["src"],B={key:4};function D(e,t,n,s,i,o){return Object(c["h"])(),Object(c["c"])("div",j,[Object(c["d"])("img",{src:`${e.public_path}images/games/${e.number}/${e.active_pic}.webp`,class:"game_pic"},null,8,f),k,Object(c["d"])("div",v,[Object(c["d"])("div",null,[Object(c["d"])("button",{onClick:t[0]||(t[0]=t=>e.showLocationImage(1)),class:Object(c["g"])(e.getClassForLocationImage(1))}," 1 ",2),Object(c["d"])("button",{onClick:t[1]||(t[1]=t=>e.showLocationImage(2)),class:Object(c["g"])(e.getClassForLocationImage(2))}," 2 ",2),Object(c["d"])("button",{onClick:t[2]||(t[2]=t=>e.showLocationImage(3)),class:Object(c["g"])(e.getClassForLocationImage(3))}," 3 ",2),Object(c["d"])("button",{onClick:t[3]||(t[3]=t=>e.showLocationImage(4)),class:Object(c["g"])(e.getClassForLocationImage(4))}," 4 ",2)])]),"playing"==this.getState()?(Object(c["h"])(),Object(c["c"])("div",x,[Object(c["d"])("h3",null,Object(c["n"])(e.guessesLeftCount())+" GUESSES LEFT",1)])):(Object(c["h"])(),Object(c["c"])("div",w,["win"==this.getState()?(Object(c["h"])(),Object(c["c"])("div",C,[I,Object(c["d"])("h3",null,"WITH "+Object(c["n"])(e.guessesLeftCount())+" GUESSES LEFT",1)])):Object(c["b"])("",!0),"lose"==this.getState()?(Object(c["h"])(),Object(c["c"])("div",S,E)):Object(c["b"])("",!0),Object(c["d"])("h3",null,"NEXT LOCATION IN "+Object(c["n"])(e.countdownUntilTomorrow),1)])),L,Object(c["d"])("canvas",{id:"canvas",onClick:t[4]||(t[4]=(...t)=>e.canvasClick&&e.canvasClick(...t))}),M,"playing"==this.getState()?(Object(c["h"])(),Object(c["c"])("div",N,[Object(c["d"])("button",{class:Object(c["g"])(null==this.selected_x?"submit disabled":"submit"),onClick:t[5]||(t[5]=(...t)=>e.submitButton&&e.submitButton(...t))}," SUBMIT ",2)])):(Object(c["h"])(),Object(c["c"])("div",U,[Object(c["d"])("button",{onClick:t[6]||(t[6]=(...t)=>e.shareClick&&e.shareClick(...t)),class:"submit"},Object(c["n"])(this.share_text),1)])),Object(c["d"])("img",{id:"map",src:`${e.public_path}maps/${e.map}.webp`,hidden:"true"},null,8,P),Object(c["d"])("img",{id:"target_icon",src:this.public_path+"images/blad_kiryu.webp",hidden:"true"},null,8,A),e.debug_mode?(Object(c["h"])(),Object(c["c"])("div",B,[Object(c["d"])("p",null,"DEBUG X:"+Object(c["n"])(this.click_debug_x),1),Object(c["d"])("p",null,"DEBUG Y:"+Object(c["n"])(this.click_debug_y),1)])):Object(c["b"])("",!0)])}var G;function R(e,t){const n=t+"=",c=decodeURIComponent(e.cookie),s=c.split(";");for(let i=0;i<s.length;i++){let e=s[i];while(" "==e.charAt(0))e=e.substring(1);if(0==e.indexOf(n))return e.substring(n.length,e.length)}return""}(function(e){e[e["NotFinal"]=0]="NotFinal",e[e["Win"]=1]="Win",e[e["Lose"]=2]="Lose"})(G||(G={}));const Y="guesses";function F(e){e.cookie=""}function z(e){const t=R(e,Y);return""!=t?JSON.parse(t):{guesses:{}}}function W(e,t){const n=z(e),c=n.guesses;return t in c?c[t]:[]}function H(e,t,n,c,s){const i=z(e);t in i.guesses||(i.guesses[t]=[]),i.guesses[t].push({x_per:n,y_per:c,final_guess:s});const o=new Date;o.setTime(o.getTime()+31536e8);const a="expires="+o.toUTCString();e.cookie=Y+"="+JSON.stringify(i)+";"+a}const J=4;let K=class extends O["b"]{};K=Object(p["a"])([Object(O["a"])({props:{map:String,number:Number,target:{x:Number,y:Number},threshold:Number,debug_mode:Boolean,on_complete:Function},data(){return{active_pic:1,canvas:null,selected_x:null,selected_y:null,center_x:null,center_y:null,guesses:[],state:"playing",share_text:"SHARE!",image_width:null,image_height:null,click_debug_x:null,click_debug_y:null,canvas_init:!1,public_path:"/kiryueverywhere/",countdownUntilTomorrow:"",countdownUntilTomorrowTimer:null}},mounted(){var e=document.getElementById("canvas");this.canvas=e.getContext("2d"),this.timer=setInterval(()=>{this.draw()},250),this.countdownUntilTomorrowTimer=setInterval(()=>{this.countdownUntilTomorrow=this.countDownUntilNextLocation()},1e3)},beforeDestroy(){clearInterval(this.timer),clearInterval(this.countdownUntilTomorrowTimer)},methods:{countDownUntilNextLocation(){let e=new Date;const t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0);t.setTime(t.getTime()+864e5);const n=t.getTime()-e.getTime(),c=Math.floor(n%864e5/36e5),s=Math.floor(n%36e5/6e4),i=Math.floor(n%6e4/1e3);return`${c.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},getState(){const e=W(document,this.number);for(const t of e){if(t.final_guess==G.Win)return"win";if(t.final_guess==G.Lose)return"lose"}return"playing"},guessesLeftCount(){return J-W(document,this.number).length},unlockedImage(){const e=W(document,this.number).length+1;return Math.min(e,J)},showLocationImage(e){(e<=this.unlockedImage()||"playing"!=this.getState())&&(this.active_pic=e)},unlockNext(){this.active_pic=Math.min(this.unlockedImage()+1,J)},getClassForLocationImage(e){return this.active_pic==e?"game_btn_active":this.unlockedImage()>=e?"game_btn_unlocked":"playing"!=this.getState()?"game_btn_unlocked_completed":"game_btn_inactive"},percentAsPos(e,t){return{x:e/100*this.image_width+this.center_x,y:t/100*this.image_height+this.center_y}},posAsPercent(e){return{x:(e.x-this.center_x)/this.image_width*100,y:(e.y-this.center_y)/this.image_height*100}},correctGuess(e){const t=this.posAsPercent({x:e.x,y:e.y}),n=Math.abs(t.x-this.target.x),c=Math.abs(t.y-this.target.y),s=document.getElementById("map");return this.click_debug_x=`px:${t.x} sx:${this.selected_x} cx:${this.center_x} iw:${s.width}`,this.click_debug_y=`py:${t.y} sy:${this.selected_y} cy:${this.center_y} ih:${s.height}`,n<=this.threshold&&c<=this.threshold},shareClick(){let e=`#KIRYU_EVERYWHERE #${this.number}\n\n`;e+="🗺️";const t=W(document,this.number);for(const c of t)this.correctGuess(c)?e+=" 🟩":e+=" 🟥";for(let c=0;c<this.guessesLeftCount();c++)e+=" ⬛";e+="\n\n",e+="https://sardap.github.io/kiryueverywhere/",navigator.clipboard.writeText(e),this.share_text="COPPIED!";let n=setInterval(()=>{this.share_text="SHARE!",clearInterval(n)},250)},submitButton(){if(null==this.selected_x||null==this.selected_y)return;const e=this.posAsPercent({x:this.selected_x,y:this.selected_y});console.log(`CLICK ${e.x}% ${e.y}%`);const t=Math.abs(e.x-this.target.x),n=Math.abs(e.y-this.target.y),c=document.getElementById("map");this.click_debug_x=`px:${e.x} sx:${this.selected_x} cx:${this.center_x} iw:${c.width}`,this.click_debug_y=`py:${e.y} sy:${this.selected_y} cy:${this.center_y} ih:${c.height}`;const s=W(document,this.number).length;let i=G.NotFinal;this.correctGuess({x:this.selected_x,y:this.selected_y})?(console.log("win!"),i=G.Win):this.guessesLeftCount()-1==0?(console.log("lose!"),i=G.Lose):(console.log("unlock next! "+s),this.unlockNext(),console.log(`failure!: dist_x:${t}, dist_y:${n}, threshold:${this.threshold}`)),H(document,this.number,e.x,e.y,i),this.selected_x=null,this.selected_y=null,this.draw()},canvasClick(e){"playing"==this.getState()&&(this.selected_x=e.offsetX,this.selected_y=e.offsetY,this.draw())},drawMap(){let e=this.canvas;const t=e.canvas.width,n=e.canvas.height;e.clearRect(0,0,t,n);const c=document.getElementById("map"),s=Math.min(t/c.width,n/c.height);this.image_width=c.width*s,this.image_height=c.height*s;const i=t/2-this.image_width/2,o=n/2-this.image_height/2;this.center_x=t/2,this.center_y=n/2,e.drawImage(c,i,o,this.image_width,this.image_height)},draw(){let e=this.canvas;if(e.clearRect(0,0,e.width,e.height),!this.canvas_init){this.canvas_init=!0;const t=.8*window.innerWidth,n=.5*window.innerHeight;e.canvas.width=t,e.canvas.height=n}this.drawMap();const t=W(document,this.number),n=.05*e.canvas.height;for(const c of t){const t=this.percentAsPos(c.x_per,c.y_per),s=Math.abs(c.x_per-this.target.x),i=Math.abs(c.y_per-this.target.y);e.beginPath();let o="";if(s<=this.threshold&&i<=this.threshold)o="green";else{const e=s+i;o=e<3.5*this.threshold?"#FF0000":"#8B0000"}e.strokeStyle=o,e.rect(t.x-n/2,t.y-n/2,n,n),e.stroke()}if(this.selected_x&&this.selected_y&&(e.beginPath(),e.strokeStyle="Black",e.rect(this.selected_x-n/2,this.selected_y-n/2,n,n),e.stroke()),"playing"!=this.getState()){const t=document.getElementById("target_icon"),c=this.percentAsPos(this.target.x,this.target.y);e.beginPath(),e.drawImage(t,c.x-n/2,c.y-n/2,n,n),e.stroke()}}}})],K);var V=K,X=(n("81cf"),n("6b0d")),q=n.n(X);const Q=q()(V,[["render",D],["__scopeId","data-v-31c4f660"]]);var Z=Q;const ee={1:{map:"yakuza_3_kamuro_map",target:{x:-42,y:-17}},2:{map:"yakuza_kwamai_map",target:{x:16,y:46}},3:{map:"yakuza_0_osaka_map",target:{x:21,y:-29}},4:{map:"yakuza_0_kamuro_map",target:{x:9,y:-1}}},te={yakuza_3_kamuro_map:{threshold:5,game_name:"Yakuza 3"},yakuza_kwamai_map:{threshold:5,game_name:"Yakuza Kiwami"},yakuza_0_kamuro_map:{threshold:5,game_name:"Yakuza 0"},yakuza_0_osaka_map:{threshold:5,game_name:"Yakuza 0"}},ne=new Date(2022,6,28,0,0,0);function ce(){let e=new Date;const t=864e5,n=e.getTime(),c=ne.getTime();return Math.floor(Math.abs((n-c)/t))}let se=class extends O["b"]{};se=Object(p["a"])([Object(O["a"])({components:{Game:Z},data(){const e=ce();return{debug_mode:!1,current_cookie:z(document),location_number:e,game_found:Object.keys(ee).length>=e}},methods:{onComplete(){console.log("Jobs done")},resetCookie(){F(document)},getMap(){return ee[this.location_number].map},getTarget(){return ee[this.location_number].target},getGameName(){return te[ee[this.location_number].map].game_name},getThreshold(){return te[ee[this.location_number].map].threshold}}})],se);var ie=se;n("9244");const oe=q()(ie,[["render",_]]);var ae=oe;Object(c["a"])(ae).mount("#app")}});
//# sourceMappingURL=app.ef28a122.js.map